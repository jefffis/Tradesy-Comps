<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
	    <meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1" />
	    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Tradesy.com Filters</title>
		<link rel="stylesheet" href="css/app.css" />
	</head>
	<body>

		<header></header>

		<div id="content">
			<div id="filter-sort">
				<button type="button" class="toggle-filters">Filter</button>
				<!-- <button type="button">Sort By</button> -->
			</div>
		</div>
		<div id="filters">
			<div id="intro">
				Filter Items:
				<button type="button" class="toggle-filters"></button>
			</div>
			<div id="filter-wrapper">
				<div class="filter department" data-toggleable>
					<h2 data-selected="All">Department</h2>
					<div>
						<label>
							<input type="radio" name="department" value="All" checked />
							<span>All</span>
						</label>
						<label>
							<input type="radio" name="department" value="Clothing" data-sizing />
							<span>Clothing</span>
						</label>
						<label>
							<input type="radio" name="department" value="Bags" />
							<span>Bags</span>
						</label>
						<label>
							<input type="radio" name="department" value="Shoes" data-sizing />
							<span>Shoes</span>
						</label>
						<label>
							<input type="radio" name="department" value="Accessories" />
							<span>Accessories</span>
						</label>
						<label>
							<input type="radio" name="department" value="Weddings" />
							<span>Weddings</span>
						</label>
					</div>
				</div>
				<div class="filter department" data-toggleable style="display: none;">
					<h2 data-selected="All">Shoes</h2>
					<div>
						<label>
							<input type="radio" name="shoes" value="All" data-sizing checked />
							<span>All</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Boots &amp; Booties" data-sizing />
							<span>Boots &amp; Booties</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Flats" data-sizing />
							<span>Flats</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Mules &amp; Clogs" data-sizing />
							<span>Mules &amp; Clogs</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Pumps" data-sizing />
							<span>Pumps</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Sandals" data-sizing />
							<span>Sandals</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Athletic" data-sizing />
							<span>Athletic</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Platforms" data-sizing />
							<span>Platforms</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Wedges" data-sizing />
							<span>Wedges</span>
						</label>
						<label>
							<input type="radio" name="shoes" value="Formal" data-sizing />
							<span>Formal</span>
						</label>
					</div>
				</div>
				<hr />
				<div class="filter-card">
					<div id="sizing" style="display: none;">
						<h2>Size</h2>
						<div id="size"></div>
					</div>
					<h2>Price</h2>
					<div id="slider" data-selected="Under $25" data-selected-after="Over $500">
						<span>Under $25</span>
						<span>Over $500</span>
					</div>
					<hr />
					<h2 data-selected="All items">Sale</h2>
					<div id="toggle"></div>
					<hr />
					<h2>Availability</h2>
					<div id="tab" class="cf">
						<span class="active">All Items</span>
						<span>In Stock</span>
						<span>Sold Out</span>
					</div>
				</div>
				<div class="filter" data-toggleable>
					<h2 data-selected="All">Designer</h2>
					<div>
						<label>
							<input type="radio" name="designer" value="All" data-return checked />
							<span>All</span>
						</label>
						<label>
							<input type="radio" name="designer" value="Louis Vuitton" data-return />
							<span>Louis Vuitton</span>
						</label>
						<label>
							<input type="radio" name="designer" value="Chanel" data-return />
							<span>Chanel</span>
						</label>
					</div>
				</div>
				<hr />
				<div class="filter">
					<h2 data-selected="All">Color</h2>
				</div>
				<hr />
				<div class="filter">
					<h2 data-selected="All">Collection</h2>
				</div>
				<hr />
				<div class="filter">
					<h2 data-selected="All">Condition</h2>
				</div>
				<hr />
				<div class="filter">
					<h2 data-selected="All">Discount</h2>
				</div>
			</div>
			<div id="apply">
				<button>Apply Filters</button>
				<!-- <button>Reset</button> -->
			</div>
		</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script>

			$(function() {
				var button = $('.toggle-filters'),
					filters = $('#filters'),
					tabs = $('span', '#tab'),
					toggle = $('#toggle'),
					apply = $('#apply'),
					toggleableDiv = $('.filter'),
					radios = $('input[type=radio]'),
					sizing = $('#sizing'),
					ajaxOverlay = '<div id="ajax-overlay"></div>';

				if ( window.innerWidth > 500 ) {
					$('html').addClass('is-tablet');
					$('.department:first').hide();
					$('.department:last').show();
					sizing.show();
				}

				button.on('click', function() {

					if ( !filters.hasClass('show') ) {
						filters.addClass('show');
						enableStickyButton($('#apply'), filters, true);
					} else {
						filters.removeClass('show');
						enableStickyButton($('#apply'), filters, false);
					}

				});

				toggle.on('click', function() {
					var ctx = $(this).hasClass('active') ? 'All items' : 'Sale items only';

					ajaxUpdateFilters(ajaxOverlay);
					toggle.toggleClass('active');
					setDataAttr(toggle.prev('h2'), ctx);
				});

				tabs.on('click', function() {
					ajaxUpdateFilters(ajaxOverlay);
					tabs.removeClass('active');
					$(this).addClass('active');
				});

				radios.on('click', function() {
					ajaxUpdateFilters(ajaxOverlay);
				});

				toggleableDiv.on('click', function() {
					if ( $(this).data('toggleable') !== undefined ) {
						$(this).find('h2').toggleClass('open');
						$(this).find('div').toggle();
						if ( $(this).find('input:checked').length ) {
							setDataAttr($(this).find('h2'), $(this).find('input:checked'));
						}
					}
				});

				apply.on('click', function() {
					fuaxSubmit($(this), filters, false);
				});

			});

			function ajaxUpdateFilters(content) {
				setTimeout(function() {
					$('html').append(content);
				}, 251);
				setTimeout(function() {
					$('#ajax-overlay').remove();
				}, 751);
			}

			function setDataAttr(el, selected) {
				var val = selected.val(),
					size = selected.data('sizing') !== undefined ? true : false,
					selectdReturn = selected.data('return') !== undefined ? true : false;

				setTimeout(function() {
					el.attr('data-selected', val);
					if ( selectdReturn ) {
						return;
					}
					if ( size ) {
						$('#sizing').show();
					} else {
						$('#sizing').hide();
					}
				}, 751);
			}

			function fuaxSubmit(el, parEl, ctx) {
				el.find('button').text('').prop('disabled', true);
				setTimeout(function() {
					// parEl.removeClass('show');
					// enableStickyButton(el, parEl, ctx);
					location.reload();
				}, 750);
			}

			function enableStickyButton(el, parEl, ctx) {
				var css = ctx ? 'fixed' : 'absolute',
					parCss = ctx ? 'absolute' : 'fixed';

				if ( !ctx ) {
					parEl.css('position', parCss);
					el.css('position', css).find('button').text('Apply Filters').prop('disabled', false);
					return;
				}

				setTimeout(function() {
					parEl.css('position', parCss);
					el.css('position', css);
				}, 251);
			}

		</script>
		
	</body>
</html>